# Description:Cinnamon file manager (Nautilus fork).
# URL: http://cinnamon.linuxmint.com/
# Maintainer: https://github.com/linuxmint
# Packager: fanch at orange do fr thierryn1 at hispeed dot ch
# Depends on: libexif gvfs dconf desktop-file-utils exempi python cinnamon-desktop libnotify libxml cinnamon-translations

name=nemo
version=2.6.7
release=1
source=()
_gitroot=https://github.com/linuxmint/nemo.git
_gitname=nemo

build() {
	cd $SRC
	
	if [[ -d $_gitname ]]; then
		cd $_gitname && git pull origin
	else
		git clone $_gitroot $_gitname
	fi


	rm -rf $SRC/$_gitname-build
	git clone $SRC/$_gitname $SRC/$_gitname-build
	cd $SRC/$_gitname-build
	
	 # Python2 fix
  find -type f | xargs sed -i 's@^#!.*python$@#!/usr/bin/python2@'

  # Rename 'Files' app name to avoid having the same as nautilus
  sed -i 's/^Name\(.*\)=.*/Name\1=Nemo/' data/nemo.desktop.in.in
  
  ./autogen.sh 	--prefix=/usr \
				--sysconfdir=/etc \
      --localstatedir=/var --disable-static \
      --libexecdir=/usr/lib/nemo \
      --disable-update-mimedb \
      --disable-tracker \
      --disable-gtk-doc-html \
      --disable-schemas-compile
    make 
	
    make DESTDIR=$PKG install
	make -C src DESTDIR=$PKG uninstall-binPROGRAMS uninstall-desktopfilesDATA
	make -C src/tools DESTDIR=$PKG uninstall
	make -C src/compositor/plugins DESTDIR=$PKG uninstall
	make -C doc/man DESTDIR=$PKG uninstall
}
