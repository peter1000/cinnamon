# Description: Screensaver designed to integrate well with the Cinnamon desktop.
# URL: http://cinnamon.linuxmint.com/
# Maintainer: https://github.com/linuxmint
# Packager: fanch at orange do fr thierryn1 at hispeed dot ch
# Depends on: cinnamon-desktop cinnamon-translations dbus-glib libgnomekbd python-gobject2 webkit


name=cinnamon-screensaver
version=2.6.4
release=1
source=(etc/pam.d/cinnamon-screensaver)
_gitroot=https://github.com/linuxmint/cinnamon-screensaver.git
_gitname=cinnamon-screensaver

build() {
	cd $SRC
	
	if [[ -d $_gitname ]]; then
		cd $_gitname && git pull origin
	else
		git clone $_gitroot $_gitname
	fi


	rm -rf $SRC/$_gitname-build
	git clone $SRC/$_gitname $SRC/$_gitname-build
	cd $SRC/$_gitname-build

	# Python2 fix
	sed -i 's@^#!.*python$@#!/usr/bin/python2@' data/screensavers/*/main
	
      ./autogen.sh 	--prefix=/usr \
					--sysconfdir=/etc \
					--libexecdir=/usr/lib/cinnamon-$name \
					--localstatedir=/var \
					--with-mit-ext \
					--with-systemd
    
    make 
	
    make DESTDIR=$PKG install
install -Dm644 ../cinnamon-screensaver.pam  $PKG/etc/pam.d/cinnamon-screensaver
}
