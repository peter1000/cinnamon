# Description: Library with common API for various Cinnamon modules.
# URL: http://cinnamon.linuxmint.com/
# Maintainer: https://github.com/linuxmint
# Packager: fanch at orange do fr thierryn1 at hispeed dot ch
# Depends on: cjs gtk3 xorg-libxkbfile python glib libgsystem 


name=cinnamon-desktop
version=2.6.5
release=1
source=(gnome-3.14.patch)
_gitroot=https://github.com/linuxmint/cinnamon-desktop.git
_gitname=cinnamon-desktop

build() {
	cd $SRC
	
	if [[ -d $_gitname ]]; then
		cd $_gitname && git pull origin
	else
		git clone $_gitroot $_gitname
	fi


	rm -rf $SRC/$_gitname-build
	git clone $SRC/$_gitname $SRC/$_gitname-build
	cd $SRC/$_gitname-build
	
  # Some fixes for GNOME 3.14
  patch -Np1 -i ../gnome-3.14.patch

  # Arch uses systemd
  sed -i 's|false|true|g' schemas/org.cinnamon.desktop.session.gschema.xml.in.in
  # Fix build failure 
  sed -i 's|subdir-objects||g' configure.ac
  
   ./autogen.sh --prefix=/usr \
   --sysconfdir=/etc \
   --localstatedir=/var \
    --libexecdir=/usr/lib/$name \ 
    --disable-static
    
    make 
	
    make DESTDIR=$PKG install
}
